<!doctype html>
<html lang="fr">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Récompense - Scrabble des licornes</title>
    <link rel="stylesheet" href="/assets/css/recompense.css">
</head>

<body>
    <main class="jeu jeu--recompense" role="application" aria-label="Scrabble des licornes - Récompense">

        <section class="panneau" aria-label="Golden Ticket">
            <div class="panneau__bois" role="group" aria-label="Panneau récompense">

                <h1 class="titre">Scrabble des licornes</h1>

                <!-- Ticket 3D -->
                <div class="scene">
                    <div class="ticket3d" id="ticket3d" aria-label="Golden Ticket manipulable">
                        <div class="face front">
                            <img src="../assets/images/ticket_front.png" alt="Ticket recto" draggable="false">
                        </div>
                        <div class="face back">
                            <img src="../assets/images/ticket_back.png" alt="Ticket verso" draggable="false">
                        </div>
                    </div>
                </div>

                <p class="hint">Fais glisser le ticket pour le tourner</p>

            </div>


        </section>


        <!-- Navigation bas -->
        <footer class="actions actions--nav" aria-label="Actions">
            <a href="/index.html" class="btn btn--back">Rejouer</a>
            <a href="score.html" class="btn btn--next">Scores</a>
        </footer>
    </main>

    <script>
        // Ticket 3D : rotation libre (souris + mobile)
        (() => {
            const ticket = document.getElementById("ticket3d");
            if (!ticket) return;

            let dragging = false;
            let lastX = 0, lastY = 0;
            let rotX = 0, rotY = 0;

            const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

            function apply() {
                ticket.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`;
            }

            ticket.addEventListener("pointerdown", (e) => {
                dragging = true;
                lastX = e.clientX;
                lastY = e.clientY;
                ticket.setPointerCapture(e.pointerId);
            });

            ticket.addEventListener("pointermove", (e) => {
                if (!dragging) return;

                const dx = e.clientX - lastX;
                const dy = e.clientY - lastY;

                rotY += dx * 0.35;
                rotX -= dy * 0.35;
                rotX = clamp(rotX, -85, 85);

                lastX = e.clientX;
                lastY = e.clientY;

                apply();
            });

            function endDrag() { dragging = false; }

            ticket.addEventListener("pointerup", endDrag);
            ticket.addEventListener("pointercancel", endDrag);
            ticket.addEventListener("lostpointercapture", endDrag);

            ticket.addEventListener("dblclick", () => {
                rotX = 0; rotY = 0;
                apply();
            });

            apply();
        })();
    </script>
</body>

</html>